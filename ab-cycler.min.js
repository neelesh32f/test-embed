!function(){"use strict";class t{constructor(t={}){this.config={apiEndpoint:t.apiEndpoint||"https://ff09-223-185-131-191.ngrok-free.app",interval:t.interval||3e3,animationDuration:t.animationDuration||300,initDelay:t.initDelay||1e3,...t},this.variations=null,this.currentVariationIndex={},console.log("Config: ",this.config),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>this.waitForScriptsAndInit())):this.waitForScriptsAndInit()}waitForScriptsAndInit(){console.log("Waiting for scripts and init..."),setTimeout((async()=>{try{"complete"!==document.readyState?window.addEventListener("load",(()=>this.init())):await this.init()}catch(t){console.error("Error in waitForScriptsAndInit:",t)}}),this.config.initDelay)}async init(){console.log("Initializing...");try{const t=await this.fetchVariations();t&&"object"==typeof t&&Object.keys(t).length>0?(this.variations=t,console.log("Valid variations received:",this.variations),this.startCycling()):console.log("No valid variations available for current page")}catch(t){console.error("Failed to initialize ABCycler:",t)}}async fetchVariations(){console.log("Fetching variations...");try{const t=window.location.href.split("/products/")[1].split("/")[0];console.log("Product slug:",t.split(".")[0]);const i=`${this.config.apiEndpoint}/planttherapy/products/${t}`;console.log("Fetching from URL:",i);const n=await fetch(i);if(!n.ok)return console.error(`HTTP error! status: ${n.status}`),null;const o=await n.json();return o&&"object"==typeof o&&0!==Object.keys(o).length?(Object.keys(o).forEach((t=>{this.currentVariationIndex[t]=0})),o):(console.log("No valid variations in API response"),null)}catch(t){return console.error("Failed to fetch variations:",t),null}}startCycling(){if(!this.variations||"object"!=typeof this.variations)return void console.log("No variations to cycle through");const t=Object.keys(this.variations);0!==t.length?t.forEach((t=>{const i=this.variations[t];Array.isArray(i)&&i.length>0?this.cycleElement(t):console.log(`No valid variations for selector: ${t}`)})):console.log("No selectors found in variations")}cycleElement(t){const i=document.querySelector(t);i?setInterval((()=>{const n=this.variations[t];if(!Array.isArray(n)||0===n.length)return;const o=this.currentVariationIndex[t],e=(o+1)%n.length;this.applyVariation(i,n[o],n[e]),this.currentVariationIndex[t]=e}),this.config.interval):console.log(`Element not found for selector: ${t}`)}applyVariation(t,i,n){t.classList.add("ab-cycler-transition"),setTimeout((()=>{this.updateElement(t,n),t.classList.remove("ab-cycler-transition")}),this.config.animationDuration)}updateElement(t,i){i.html&&(t.innerHTML=i.html),i.text&&(t.textContent=i.text),i.attributes&&Object.entries(i.attributes).forEach((([i,n])=>{t.setAttribute(i,n)})),i.styles&&Object.assign(t.style,i.styles)}}window.createABCycler=function(i){return new t(i)}}();
//# sourceMappingURL=ab-cycler.min.js.map
